

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; django_twitter 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="django_twitter.management.commands" href="commands.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> django_twitter
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Abstract Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">Management Commands</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#settings-py">settings.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#models-py">models.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-accounts-and-downloading-profile-data">Adding accounts and downloading profile data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#collecting-tweets">Collecting tweets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#profile-and-tweet-sets">Profile and tweet sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#followers-and-followings-lists">Followers and followings lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-auditing-utilities-looking-for-account-and-coverage-errors">Data auditing utilities (looking for account and coverage errors)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#extracting-exporting-data">Extracting/exporting data</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">django_twitter</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>Django Twitter is designed to make it easy to collect and store data
from Twitter in a database, using Django. It is layered on top of
Pewhooks - our collection of Python utilities for interfacing with
various APIs, including Twitter - and provides a set of standardized
abstract Django models and Django commands for querying the Twitter API
and storing the data you get back.</p>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>In the following examples, we have a test app set up that has Django
Twitter installed like so:</p>
<div class="section" id="settings-py">
<h3>settings.py<a class="headerlink" href="#settings-py" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">INSTALLED_APPS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;django.contrib.auth&quot;</span><span class="p">,</span>
    <span class="s2">&quot;django.contrib.contenttypes&quot;</span><span class="p">,</span>
    <span class="s2">&quot;django.contrib.sites&quot;</span><span class="p">,</span>
    <span class="s2">&quot;django_twitter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;testapp&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">TWITTER_APP</span> <span class="o">=</span> <span class="s2">&quot;testapp&quot;</span>
</pre></div>
</div>
<p>And in our app’s <code class="docutils literal notranslate"><span class="pre">models.py</span></code> file, we import all of the abstract
models that Django Twitter provides, and create them as concrete models
in our own app. The abstract models define a “template” for how to store
Twitter data, but the tables will be created for and belong to our own
app. You’ll also notice that we have two other tables in our app -
<code class="docutils literal notranslate"><span class="pre">Person</span></code> and <code class="docutils literal notranslate"><span class="pre">Organization</span></code>. What’s nice about Django Twitter
providing <em>abstract</em> models is that you can build on the model templates
and extend them with additional data however you like. In our app, we’re
going to add some additional metadata on who owns each Twitter account,
and store that info in other custom tables in our app.</p>
</div>
<div class="section" id="models-py">
<h3>models.py<a class="headerlink" href="#models-py" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django_twitter.models</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Organization</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">TwitterProfile</span><span class="p">(</span><span class="n">AbstractTwitterProfile</span><span class="p">):</span>

    <span class="n">person</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s2">&quot;testapp.Person&quot;</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;twitter_profiles&quot;</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">SET_NULL</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">organization</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span>
        <span class="s2">&quot;testapp.Organization&quot;</span><span class="p">,</span>
        <span class="n">related_name</span><span class="o">=</span><span class="s2">&quot;twitter_profiles&quot;</span><span class="p">,</span>
        <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">on_delete</span><span class="o">=</span><span class="n">models</span><span class="o">.</span><span class="n">SET_NULL</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">class</span> <span class="nc">TwitterProfileSnapshot</span><span class="p">(</span><span class="n">AbstractTwitterProfileSnapshot</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">Tweet</span><span class="p">(</span><span class="n">AbstractTweet</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TwitterFollowerList</span><span class="p">(</span><span class="n">AbstractTwitterFollowerList</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TwitterFollowingList</span><span class="p">(</span><span class="n">AbstractTwitterFollowingList</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TwitterHashtag</span><span class="p">(</span><span class="n">AbstractTwitterHashtag</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TwitterPlace</span><span class="p">(</span><span class="n">AbstractTwitterPlace</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TweetSet</span><span class="p">(</span><span class="n">AbstractTweetSet</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TwitterProfileSet</span><span class="p">(</span><span class="n">AbstractTwitterProfileSet</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>Finally, we’re going to grab our Twitter credentials and save them as
environment variables. Django Twitter allows you to manually pass your
Twitter credentials to all of its data collection commands, but it’s
much easier to take advantage of Pewhooks’ support for environment
variables and let it fetch them automatically. The variables it needs
are <code class="docutils literal notranslate"><span class="pre">TWITTER_API_KEY</span></code>, <code class="docutils literal notranslate"><span class="pre">TWITTER_API_SECRET</span></code>,
<code class="docutils literal notranslate"><span class="pre">TWITTER_API_ACCESS_TOKEN</span></code>, <code class="docutils literal notranslate"><span class="pre">TWITTER_API_ACCESS_SECRET</span></code>.</p>
<p>With our credentials set and the above two files figured out, we’ve now
got Django Twitter all configured. We just need to run
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">makemigrations</span> <span class="pre">testapp</span></code> and
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></code> to actually create the tables, and then
we’re ready to load in some data! Below is the list of accounts we’re
going to track.</p>
</div>
</div>
<div class="section" id="adding-accounts-and-downloading-profile-data">
<h2>Adding accounts and downloading profile data<a class="headerlink" href="#adding-accounts-and-downloading-profile-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MY_ACCOUNTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;pewresearch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewglobal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewmethods&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewjournalism&quot;</span><span class="p">,</span>
    <span class="s2">&quot;facttank&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewscience&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewreligion&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewhispanic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewinternet&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pvankessel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;justinbieber&quot;</span><span class="p">,</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Django Twitter provides a bunch of built-in management commands that
make it easy to collect Twitter data. If we wanted to start pulling in
data for these profiles, we could run the following command from the CLI
and Django Twitter would hit the API and store the results in the
database:</p>
<p><code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">django_twitter_get_profile</span> <span class="pre">pewresearch</span></code></p>
<p>But Django also provides a <code class="docutils literal notranslate"><span class="pre">call_command</span></code> function that lets you call
management commands programatically, so that’s what we’re going to use
here.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.core.management</span> <span class="k">import</span> <span class="n">call_command</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="n">MY_ACCOUNTS</span><span class="p">:</span>
    <span class="n">call_command</span><span class="p">(</span>
        <span class="s2">&quot;django_twitter_get_profile&quot;</span><span class="p">,</span> <span class="n">handle</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewresearch</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewresearch</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewresearch</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewglobal</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewglobal</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewglobal</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewmethods</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewmethods</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewmethods</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewjournalism</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewjournalism</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewjournalism</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">facttank</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">facttank</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">facttank</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewscience</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewscience</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewscience</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewreligion</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewreligion</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewreligion</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewhispanic</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewhispanic</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewhispanic</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewinternet</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewinternet</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewinternet</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pvankessel</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pvankessel</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pvankessel</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">justinbieber</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">justinbieber</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">justinbieber</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testapp.models</span> <span class="k">import</span> <span class="n">TwitterProfile</span>
<span class="n">TwitterProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">11</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TwitterProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">screen_name</span><span class="o">=</span><span class="s1">&#39;pewresearch&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;twitter_id&#39;</span><span class="p">:</span> <span class="s1">&#39;22642788&#39;</span><span class="p">,</span> <span class="s1">&#39;last_update_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">830012</span><span class="p">),</span> <span class="s1">&#39;historical&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;tweet_backfilled&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;pewresearch&#39;</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">39</span><span class="p">),</span> <span class="s1">&#39;twitter_error_code&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;organization_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;most_recent_snapshot_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Hmm, that looks like we’ve got less data than we expected. Where’d all
the data go? Well, because Twitter profiles change over time - people
gain and lose followers, they change their descriptions (and sometimes
even their screen names) - and because we might be interested in
tracking that data, Django Twitter actually stores profile data in a
separate table, every time it queries the API. We call these “profile
snapshots” and you can access them like so:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span> <span class="o">=</span> <span class="n">TwitterProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">screen_name</span><span class="o">=</span><span class="s1">&#39;pewresearch&#39;</span><span class="p">)</span>
<span class="n">profile</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">TwitterProfileSnapshot</span><span class="p">:</span> <span class="n">pewresearch</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewresearch</span> <span class="n">AS</span> <span class="n">OF</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span> <span class="mi">14</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mf">47.799024</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span><span class="o">.</span><span class="n">snapshots</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;twitter_id&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;last_update_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">817208</span><span class="p">),</span> <span class="s1">&#39;historical&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">799024</span><span class="p">),</span> <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;pewresearch&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pew Research Center&#39;</span><span class="p">,</span> <span class="s1">&#39;contributors_enabled&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Nonpartisan, non-advocacy data and analysis on the issues, attitudes and trends shaping the world. Subscribe: https://t.co/Kpq1V0w9bM ✉️&#39;</span><span class="p">,</span> <span class="s1">&#39;favorites_count&#39;</span><span class="p">:</span> <span class="mi">892</span><span class="p">,</span> <span class="s1">&#39;followers_count&#39;</span><span class="p">:</span> <span class="mi">430625</span><span class="p">,</span> <span class="s1">&#39;followings_count&#39;</span><span class="p">:</span> <span class="mi">96</span><span class="p">,</span> <span class="s1">&#39;is_verified&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;is_protected&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;listed_count&#39;</span><span class="p">:</span> <span class="mi">13195</span><span class="p">,</span> <span class="s1">&#39;profile_image_url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://pbs.twimg.com/profile_images/879728447026868228/U4Uzpdp6_normal.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="s1">&#39;@Katrina_HRM You might also enjoy our short email mini-course on the U.S. Census authored by @allthingscensus. Less… https://t.co/hJrYbltDWh&#39;</span><span class="p">,</span> <span class="s1">&#39;statuses_count&#39;</span><span class="p">:</span> <span class="mi">90347</span><span class="p">,</span> <span class="s1">&#39;urls&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;https://www.pewresearch.org/&#39;</span><span class="p">],</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;Washington, DC&#39;</span><span class="p">,</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">22642788</span><span class="p">,</span> <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://t.co/OBLpll8VR0&#39;</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pew Research Center&#39;</span><span class="p">,</span> <span class="s1">&#39;id_str&#39;</span><span class="p">:</span> <span class="s1">&#39;22642788&#39;</span><span class="p">,</span> <span class="s1">&#39;status&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1404865073684828161</span><span class="p">,</span> <span class="s1">&#39;geo&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;lang&#39;</span><span class="p">:</span> <span class="s1">&#39;en&#39;</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">:</span> <span class="s1">&#39;@Katrina_HRM You might also enjoy our short email mini-course on the U.S. Census authored by @allthingscensus. Less… https://t.co/hJrYbltDWh&#39;</span><span class="p">,</span> <span class="s1">&#39;place&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;id_str&#39;</span><span class="p">:</span> <span class="s1">&#39;1404865073684828161&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;a href=&quot;https://about.twitter.com/products/tweetdeck&quot; rel=&quot;nofollow&quot;&gt;TweetDeck&lt;/a&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;urls&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://t.co/hJrYbltDWh&#39;</span><span class="p">,</span> <span class="s1">&#39;indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">117</span><span class="p">,</span> <span class="mi">140</span><span class="p">],</span> <span class="s1">&#39;display_url&#39;</span><span class="p">:</span> <span class="s1">&#39;twitter.com/i/web/status/1…&#39;</span><span class="p">,</span> <span class="s1">&#39;expanded_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://twitter.com/i/web/status/1404865073684828161&#39;</span><span class="p">}],</span> <span class="s1">&#39;symbols&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;hashtags&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;user_mentions&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">77834136</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Katrina Jones&#39;</span><span class="p">,</span> <span class="s1">&#39;id_str&#39;</span><span class="p">:</span> <span class="s1">&#39;77834136&#39;</span><span class="p">,</span> <span class="s1">&#39;indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Katrina_HRM&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">356872253</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;All Things Census&#39;</span><span class="p">,</span> <span class="s1">&#39;id_str&#39;</span><span class="p">:</span> <span class="s1">&#39;356872253&#39;</span><span class="p">,</span> <span class="s1">&#39;indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">93</span><span class="p">,</span> <span class="mi">109</span><span class="p">],</span> <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;allthingscensus&#39;</span><span class="p">}]},</span> <span class="s1">&#39;favorited&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;retweeted&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;truncated&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="s1">&#39;Tue Jun 15 18:15:09 +0000 2021&#39;</span><span class="p">,</span> <span class="s1">&#39;coordinates&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;contributors&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;retweet_count&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;favorite_count&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;is_quote_status&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;possibly_sensitive&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;in_reply_to_user_id&#39;</span><span class="p">:</span> <span class="mi">77834136</span><span class="p">,</span> <span class="s1">&#39;in_reply_to_status_id&#39;</span><span class="p">:</span> <span class="mi">1404850695715659777</span><span class="p">,</span> <span class="s1">&#39;in_reply_to_screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Katrina_HRM&#39;</span><span class="p">,</span> <span class="s1">&#39;in_reply_to_user_id_str&#39;</span><span class="p">:</span> <span class="s1">&#39;77834136&#39;</span><span class="p">,</span> <span class="s1">&#39;in_reply_to_status_id_str&#39;</span><span class="p">:</span> <span class="s1">&#39;1404850695715659777&#39;</span><span class="p">},</span> <span class="s1">&#39;entities&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;urls&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://t.co/OBLpll8VR0&#39;</span><span class="p">,</span> <span class="s1">&#39;indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="s1">&#39;display_url&#39;</span><span class="p">:</span> <span class="s1">&#39;pewresearch.org&#39;</span><span class="p">,</span> <span class="s1">&#39;expanded_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://www.pewresearch.org/&#39;</span><span class="p">}]},</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;urls&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://t.co/Kpq1V0w9bM&#39;</span><span class="p">,</span> <span class="s1">&#39;indices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span> <span class="mi">133</span><span class="p">],</span> <span class="s1">&#39;display_url&#39;</span><span class="p">:</span> <span class="s1">&#39;pewresearch.org/follow-us/&#39;</span><span class="p">,</span> <span class="s1">&#39;expanded_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://www.pewresearch.org/follow-us/&#39;</span><span class="p">}]}},</span> <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s1">&#39;Washington, DC&#39;</span><span class="p">,</span> <span class="s1">&#39;verified&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;following&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;protected&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;time_zone&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="s1">&#39;Tue Mar 03 16:39:39 +0000 2009&#39;</span><span class="p">,</span> <span class="s1">&#39;utc_offset&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;Nonpartisan, non-advocacy data and analysis on the issues, attitudes and trends shaping the world. Subscribe: https://t.co/Kpq1V0w9bM ✉️&#39;</span><span class="p">,</span> <span class="s1">&#39;geo_enabled&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;pewresearch&#39;</span><span class="p">,</span> <span class="s1">&#39;listed_count&#39;</span><span class="p">:</span> <span class="mi">13195</span><span class="p">,</span> <span class="s1">&#39;friends_count&#39;</span><span class="p">:</span> <span class="mi">96</span><span class="p">,</span> <span class="s1">&#39;is_translator&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;notifications&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;statuses_count&#39;</span><span class="p">:</span> <span class="mi">90347</span><span class="p">,</span> <span class="s1">&#39;default_profile&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;followers_count&#39;</span><span class="p">:</span> <span class="mi">430625</span><span class="p">,</span> <span class="s1">&#39;translator_type&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;favourites_count&#39;</span><span class="p">:</span> <span class="mi">892</span><span class="p">,</span> <span class="s1">&#39;profile_location&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;profile_image_url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://pbs.twimg.com/profile_images/879728447026868228/U4Uzpdp6_normal.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_banner_url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://pbs.twimg.com/profile_banners/22642788/1494338667&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_link_color&#39;</span><span class="p">:</span> <span class="s1">&#39;0083B3&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_text_color&#39;</span><span class="p">:</span> <span class="s1">&#39;525151&#39;</span><span class="p">,</span> <span class="s1">&#39;follow_request_sent&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;contributors_enabled&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;has_extended_profile&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;default_profile_image&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;withheld_in_countries&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;is_translation_enabled&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;profile_background_tile&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;profile_image_url_https&#39;</span><span class="p">:</span> <span class="s1">&#39;https://pbs.twimg.com/profile_images/879728447026868228/U4Uzpdp6_normal.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_background_color&#39;</span><span class="p">:</span> <span class="s1">&#39;EFEFEF&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_sidebar_fill_color&#39;</span><span class="p">:</span> <span class="s1">&#39;DBE7ED&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_background_image_url&#39;</span><span class="p">:</span> <span class="s1">&#39;http://abs.twimg.com/images/themes/theme1/bg.png&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_sidebar_border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;DBE7ED&#39;</span><span class="p">,</span> <span class="s1">&#39;profile_use_background_image&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;profile_background_image_url_https&#39;</span><span class="p">:</span> <span class="s1">&#39;https://abs.twimg.com/images/themes/theme1/bg.png&#39;</span><span class="p">},</span> <span class="s1">&#39;profile_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>There’s the data! For convenience, you can always access the most recent
snapshot of a profile directly using the <code class="docutils literal notranslate"><span class="pre">most_recent_snapshot</span></code> field:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span><span class="o">.</span><span class="n">most_recent_snapshot</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">TwitterProfileSnapshot</span><span class="p">:</span> <span class="n">pewresearch</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewresearch</span> <span class="n">AS</span> <span class="n">OF</span> <span class="mi">2021</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">15</span> <span class="mi">14</span><span class="p">:</span><span class="mi">26</span><span class="p">:</span><span class="mf">47.799024</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="collecting-tweets">
<h2>Collecting tweets<a class="headerlink" href="#collecting-tweets" title="Permalink to this headline">¶</a></h2>
<p>Okay, now let’s get some tweets using the
<code class="docutils literal notranslate"><span class="pre">django_twitter_get_profile_tweets</span></code> command. The Twitter v1 API allows
you to go back as far as the ~3200 most recent tweets produced by an
account. With query limits, that would take a while, so we’re going to
set a limit of 25 tweets. But normally, we’d probably want to grab
everything we could, and then periodically run this command again to get
new tweets on a regular basis. Our Twitter account is pretty active -
but it’s definitely not producing 3200 tweets every day, so when we run
this command a second time, we probably don’t need to iterate through
everything all over again. Instead, Django Twitter sets a
<code class="docutils literal notranslate"><span class="pre">tweet_backfilled=True</span></code> flag on the profile the first time it works
its way through the full available feed for a profile. Then, in
subsequent runs of <code class="docutils literal notranslate"><span class="pre">django_twitter_get_profile_tweets</span></code>, it’ll default
to breaking off the data collection when it encounters a tweet it’s
already seen.</p>
<p>(Sidenote: since you’re probably collecting tweets for multiple profiles
and it’s possible that some accounts mention or retweet each other,
Django Twitter is smart enough to check for this, and it only breaks off
when it encounters a tweet that could only have been captured by
collecting the profile’s own feed.)</p>
<p>You can ignore the backfill flag by simply passing <code class="docutils literal notranslate"><span class="pre">--ignore_backfill</span></code>
to the command, and it’ll keep iterating. And, if you just want to
ignore the backfill flag for a limited timeframe (only refreshing
existing tweets up to a certain point) then you can easily pass
<code class="docutils literal notranslate"><span class="pre">--max_backfill_days</span></code> or <code class="docutils literal notranslate"><span class="pre">--max_backfill_date</span></code> to the command to
tell it how far back you want to go. Finally, Django Twitter avoids
overwriting existing tweet data, unless you pass <code class="docutils literal notranslate"><span class="pre">--overwrite</span></code>.
Combining some of these flags - like
<code class="docutils literal notranslate"><span class="pre">--ignore_backfill</span> <span class="pre">--max_backfill_days</span> <span class="pre">7</span> <span class="pre">--overwrite</span></code> - can be useful
if you want to refresh the stats (i.e. likes, retweets) for recent
tweets, but don’t care after a certain point (stats tend to level-off
after a few days, so we often stop refreshing tweets after a week).</p>
<p>Anyway, below, we’re going to collected the most recent 25 tweets for
the &#64;pewresearch account:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span>
    <span class="s2">&quot;django_twitter_get_profile_tweets&quot;</span><span class="p">,</span>
    <span class="s2">&quot;pewresearch&quot;</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">25</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Retrieving tweets for user pewresearch: 0it [00:00, ?it/s]
Retrieving tweets for user pewresearch
Retrieving tweets for user pewresearch: 24it [00:02,  8.70it/s]
pewresearch: http://twitter.com/pewresearch: 25 tweets scanned, 25 updated
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testapp.models</span> <span class="k">import</span> <span class="n">Tweet</span>
<span class="n">Tweet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">35</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TwitterProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">19</span>
</pre></div>
</div>
<p>Awesome, we’ve got tweets now! But wait, we have more tweets than we
expected, and we also have more Twitter profiles. What gives?</p>
<p>Well, Django Twitter automatically creates new records for any and all
tweets and accounts it encounters. So, if &#64;pewresearch quote tweets an
account we hadn’t seen before, both the quote tweet and the original
tweet get created in the database, along with the account that created
the quoted tweet. This is nice, because our lovely database grows and
tracks all of the data it can - but now we’ve got extra profiles. Which
ones are our original ones?</p>
<p>We could just keep using our initial list of screen names to keep track
of our “primary” accounts, but that poses another problem: screen names
can change and get recycled by new accounts. If we were to retire our
&#64;pewresearch account and it were to get snatched up by a spam bot (not
an uncommon scenario for popular handles), our queries would start
pulling in spammy tweets, and we wouldn’t even know something was wrong
unless we took a close look. The better way of tracking accounts is to
use their actually-unique Twitter IDs, which you get back from the API
the first time you query a screen name.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profile</span><span class="o">.</span><span class="n">twitter_id</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;22642788&#39;</span>
</pre></div>
</div>
<p>So now we have to go and look up all of our accounts’ <em>actual</em> IDs and
replace our list of screen names? That’s a huge pain! Wouldn’t it be
nice if we could just define lists of accounts that we care about
directly in the database?</p>
</div>
<div class="section" id="profile-and-tweet-sets">
<h2>Profile and tweet sets<a class="headerlink" href="#profile-and-tweet-sets" title="Permalink to this headline">¶</a></h2>
<p>That’s where profile and tweet sets come in. Every Django Twitter
command (where it makes sense) accepts <code class="docutils literal notranslate"><span class="pre">--add_to_profile_set</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">--add_to_tweet_set</span></code> commands that take arbitrary labels that get
associated with the profiles and/or tweets that it encounters. This
makes it really easy to give a set of profiles or tweets a name, and
then you can access that set directly in the database - and better yet,
you can also run commands directly on a <em>set</em> of profiles all at once.
Let’s see how that works.</p>
<p>Let’s repeat the process of looping over and loading in our accounts,
but this time we’re going to add them to a profile set.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="n">MY_ACCOUNTS</span><span class="p">:</span>
    <span class="n">call_command</span><span class="p">(</span>
        <span class="s2">&quot;django_twitter_get_profile&quot;</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">add_to_profile_set</span><span class="o">=</span><span class="s2">&quot;my_profile_set&quot;</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewresearch</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewresearch</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewresearch</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewglobal</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewglobal</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewglobal</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewmethods</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewmethods</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewmethods</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewjournalism</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewjournalism</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewjournalism</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">facttank</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">facttank</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">facttank</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewscience</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewscience</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewscience</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewreligion</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewreligion</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewreligion</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewhispanic</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewhispanic</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewhispanic</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewinternet</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pewinternet</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pewinternet</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pvankessel</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">pvankessel</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">pvankessel</span>
<span class="n">Collecting</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">justinbieber</span>
<span class="n">Successfully</span> <span class="n">saved</span> <span class="n">profile</span> <span class="n">data</span> <span class="k">for</span> <span class="n">justinbieber</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">twitter</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">justinbieber</span>
</pre></div>
</div>
<p>Now we can access these accounts through the profile set that we just
created:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testapp.models</span> <span class="k">import</span> <span class="n">TwitterProfileSet</span>

<span class="n">TwitterProfileSet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_profile_set&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">11</span>
</pre></div>
</div>
<p>Now, the next time we want to refresh the profile data for these
accounts, we can do it all at once by using the
<code class="docutils literal notranslate"><span class="pre">django_twitter_get_profile_set</span></code> command, no for-loop necessary - and
no need to specify those problematic screen names; Django Twitter will
use the correct unique IDs automatically:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span>
    <span class="s2">&quot;django_twitter_get_profile_set&quot;</span><span class="p">,</span> <span class="s2">&quot;my_profile_set&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  0%|          | 0/11 [00:00&lt;?, ?it/s]
Collecting profile data for 1265726480
Successfully saved profile data for facttank: http://twitter.com/facttank
  9%|▉         | 1/11 [00:00&lt;00:03,  3.17it/s]
Collecting profile data for 1262729180
Successfully saved profile data for pewscience: http://twitter.com/pewscience
 18%|█▊        | 2/11 [00:00&lt;00:02,  3.50it/s]
Collecting profile data for 36462231
Successfully saved profile data for pewreligion: http://twitter.com/pewreligion
 27%|██▋       | 3/11 [00:00&lt;00:02,  3.25it/s]
Collecting profile data for 426041590
Successfully saved profile data for pewhispanic: http://twitter.com/pewhispanic
 36%|███▋      | 4/11 [00:01&lt;00:02,  2.98it/s]
Collecting profile data for 22642788
Successfully saved profile data for pewresearch: http://twitter.com/pewresearch
 45%|████▌     | 5/11 [00:01&lt;00:01,  3.16it/s]
Collecting profile data for 831470472
Successfully saved profile data for pewglobal: http://twitter.com/pewglobal
 55%|█████▍    | 6/11 [00:01&lt;00:01,  3.48it/s]
Collecting profile data for 3015897974
Successfully saved profile data for pewmethods: http://twitter.com/pewmethods
 64%|██████▎   | 7/11 [00:02&lt;00:01,  3.74it/s]
Collecting profile data for 111339670
Successfully saved profile data for pewjournalism: http://twitter.com/pewjournalism
 73%|███████▎  | 8/11 [00:02&lt;00:00,  3.68it/s]
Collecting profile data for 17071048
Successfully saved profile data for pewinternet: http://twitter.com/pewinternet
 82%|████████▏ | 9/11 [00:02&lt;00:00,  3.70it/s]
Collecting profile data for 530977797
Successfully saved profile data for pvankessel: http://twitter.com/pvankessel
 91%|█████████ | 10/11 [00:02&lt;00:00,  3.27it/s]
Collecting profile data for 27260086
Successfully saved profile data for justinbieber: http://twitter.com/justinbieber
100%|██████████| 11/11 [00:03&lt;00:00,  3.32it/s]
</pre></div>
</div>
<p>And to download the latest tweets for <em>all</em> of these accounts, we can
now run the <code class="docutils literal notranslate"><span class="pre">django_twitter_get_profile_set_tweets</span></code> command</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span>
    <span class="s2">&quot;django_twitter_get_profile_set_tweets&quot;</span><span class="p">,</span>
    <span class="s2">&quot;my_profile_set&quot;</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_backfill</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Retrieving tweets for user facttank: 0it [00:00, ?it/s]
Retrieving tweets for user facttank
Retrieving tweets for user facttank: 24it [00:02, 11.20it/s]
facttank: http://twitter.com/facttank: 25 tweets scanned, 25 updated
Retrieving tweets for user pewscience: 0it [00:00, ?it/s]
Retrieving tweets for user pewscience
Retrieving tweets for user pewscience: 24it [00:02,  9.66it/s]
pewscience: http://twitter.com/pewscience: 25 tweets scanned, 25 updated
Retrieving tweets for user pewreligion: 0it [00:00, ?it/s]
Retrieving tweets for user pewreligion
Retrieving tweets for user pewreligion: 24it [00:02, 11.89it/s]
pewreligion: http://twitter.com/pewreligion: 25 tweets scanned, 25 updated
Retrieving tweets for user pewhispanic: 0it [00:00, ?it/s]
Retrieving tweets for user pewhispanic
Retrieving tweets for user pewhispanic: 24it [00:02,  8.59it/s]
pewhispanic: http://twitter.com/pewhispanic: 25 tweets scanned, 25 updated
Retrieving tweets for user pewresearch: 0it [00:00, ?it/s]
Retrieving tweets for user pewresearch
Retrieving tweets for user pewresearch: 24it [00:02, 11.24it/s]
pewresearch: http://twitter.com/pewresearch: 25 tweets scanned, 25 updated
Retrieving tweets for user pewglobal: 0it [00:00, ?it/s]
Retrieving tweets for user pewglobal
Retrieving tweets for user pewglobal: 24it [00:02, 11.29it/s]
pewglobal: http://twitter.com/pewglobal: 25 tweets scanned, 25 updated
Retrieving tweets for user pewmethods: 0it [00:00, ?it/s]
Retrieving tweets for user pewmethods
Retrieving tweets for user pewmethods: 24it [00:02,  8.53it/s]
pewmethods: http://twitter.com/pewmethods: 25 tweets scanned, 25 updated
Retrieving tweets for user pewjournalism: 0it [00:00, ?it/s]
Retrieving tweets for user pewjournalism
Retrieving tweets for user pewjournalism: 24it [00:01, 13.64it/s]
pewjournalism: http://twitter.com/pewjournalism: 25 tweets scanned, 25 updated
Retrieving tweets for user pewinternet: 0it [00:00, ?it/s]
Retrieving tweets for user pewinternet
Retrieving tweets for user pewinternet: 24it [00:02, 11.88it/s]
pewinternet: http://twitter.com/pewinternet: 25 tweets scanned, 25 updated
Retrieving tweets for user pvankessel: 0it [00:00, ?it/s]
Retrieving tweets for user pvankessel
Retrieving tweets for user pvankessel: 24it [00:02,  9.78it/s]
pvankessel: http://twitter.com/pvankessel: 25 tweets scanned, 25 updated
Retrieving tweets for user justinbieber: 0it [00:00, ?it/s]
Retrieving tweets for user justinbieber
Retrieving tweets for user justinbieber: 24it [00:03,  7.96it/s]
justinbieber: http://twitter.com/justinbieber: 25 tweets scanned, 25 updated
100%|██████████| 11/11 [00:29&lt;00:00,  2.67s/it]
</pre></div>
</div>
<p>We can also keep track of all the tweets we collect when we run this
command, by passing it a label for a tweet set:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span>
    <span class="s2">&quot;django_twitter_get_profile_set_tweets&quot;</span><span class="p">,</span>
    <span class="s2">&quot;my_profile_set&quot;</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_backfill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_to_tweet_set</span><span class="o">=</span><span class="s2">&quot;my_tweet_set&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Retrieving tweets for user pewscience: 0it [00:00, ?it/s]
Retrieving tweets for user pewscience
Retrieving tweets for user pewscience: 24it [00:02, 11.05it/s]
pewscience: http://twitter.com/pewscience: 25 tweets scanned, 25 updated
Retrieving tweets for user pewreligion: 0it [00:00, ?it/s]
Retrieving tweets for user pewreligion
Retrieving tweets for user pewreligion: 24it [00:02, 10.83it/s]
pewreligion: http://twitter.com/pewreligion: 25 tweets scanned, 25 updated
Retrieving tweets for user facttank: 0it [00:00, ?it/s]
Retrieving tweets for user facttank
Retrieving tweets for user facttank: 24it [00:01, 13.98it/s]
facttank: http://twitter.com/facttank: 25 tweets scanned, 25 updated
Retrieving tweets for user pewhispanic: 0it [00:00, ?it/s]
Retrieving tweets for user pewhispanic
Retrieving tweets for user pewhispanic: 24it [00:02,  8.88it/s]
pewhispanic: http://twitter.com/pewhispanic: 25 tweets scanned, 25 updated
Retrieving tweets for user pewglobal: 0it [00:00, ?it/s]
Retrieving tweets for user pewglobal
Retrieving tweets for user pewglobal: 24it [00:01, 12.44it/s]
pewglobal: http://twitter.com/pewglobal: 25 tweets scanned, 25 updated
Retrieving tweets for user pewmethods: 0it [00:00, ?it/s]
Retrieving tweets for user pewmethods
Retrieving tweets for user pewmethods: 24it [00:02, 10.44it/s]
pewmethods: http://twitter.com/pewmethods: 25 tweets scanned, 25 updated
Retrieving tweets for user pewjournalism: 0it [00:00, ?it/s]
Retrieving tweets for user pewjournalism
Retrieving tweets for user pewjournalism: 24it [00:02, 10.42it/s]
pewjournalism: http://twitter.com/pewjournalism: 25 tweets scanned, 25 updated
Retrieving tweets for user pewinternet: 0it [00:00, ?it/s]
Retrieving tweets for user pewinternet
Retrieving tweets for user pewinternet: 24it [00:02, 10.88it/s]
pewinternet: http://twitter.com/pewinternet: 25 tweets scanned, 25 updated
Retrieving tweets for user pewresearch: 0it [00:00, ?it/s]
Retrieving tweets for user pewresearch
Retrieving tweets for user pewresearch: 24it [00:02, 10.47it/s]
pewresearch: http://twitter.com/pewresearch: 25 tweets scanned, 25 updated
Retrieving tweets for user pvankessel: 0it [00:00, ?it/s]
Retrieving tweets for user pvankessel
Retrieving tweets for user pvankessel: 24it [00:02, 10.83it/s]
pvankessel: http://twitter.com/pvankessel: 25 tweets scanned, 25 updated
Retrieving tweets for user justinbieber: 0it [00:00, ?it/s]
Retrieving tweets for user justinbieber
Retrieving tweets for user justinbieber: 24it [00:02,  9.07it/s]
justinbieber: http://twitter.com/justinbieber: 25 tweets scanned, 25 updated
100%|██████████| 11/11 [00:28&lt;00:00,  2.56s/it]
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testapp.models</span> <span class="k">import</span> <span class="n">TweetSet</span>
<span class="n">TweetSet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_tweet_set&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tweets</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">275</span>
</pre></div>
</div>
<p>And we could even add those profiles to an entirely new profile set, to
keep track of data collection, for example.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span>
    <span class="s2">&quot;django_twitter_get_profile_set_tweets&quot;</span><span class="p">,</span>
    <span class="s2">&quot;my_profile_set&quot;</span><span class="p">,</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ignore_backfill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">add_to_tweet_set</span><span class="o">=</span><span class="s2">&quot;my_tweet_set&quot;</span><span class="p">,</span>
    <span class="n">add_to_profile_set</span><span class="o">=</span><span class="s2">&quot;my_second_profile_set&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Retrieving tweets for user pewreligion: 0it [00:00, ?it/s]
Retrieving tweets for user pewreligion
Retrieving tweets for user pewreligion: 24it [00:02,  9.12it/s]
pewreligion: http://twitter.com/pewreligion: 25 tweets scanned, 25 updated
Retrieving tweets for user facttank: 0it [00:00, ?it/s]
Retrieving tweets for user facttank
Retrieving tweets for user facttank: 24it [00:01, 13.87it/s]
facttank: http://twitter.com/facttank: 25 tweets scanned, 25 updated
Retrieving tweets for user pewhispanic: 0it [00:00, ?it/s]
Retrieving tweets for user pewhispanic
Retrieving tweets for user pewhispanic: 24it [00:02,  9.02it/s]
pewhispanic: http://twitter.com/pewhispanic: 25 tweets scanned, 25 updated
Retrieving tweets for user pewglobal: 0it [00:00, ?it/s]
Retrieving tweets for user pewglobal
Retrieving tweets for user pewglobal: 24it [00:01, 12.75it/s]
pewglobal: http://twitter.com/pewglobal: 25 tweets scanned, 25 updated
Retrieving tweets for user pewinternet: 0it [00:00, ?it/s]
Retrieving tweets for user pewinternet
Retrieving tweets for user pewinternet: 24it [00:02, 11.19it/s]
pewinternet: http://twitter.com/pewinternet: 25 tweets scanned, 25 updated
Retrieving tweets for user pewmethods: 0it [00:00, ?it/s]
Retrieving tweets for user pewmethods
Retrieving tweets for user pewmethods: 24it [00:02, 11.62it/s]
pewmethods: http://twitter.com/pewmethods: 25 tweets scanned, 25 updated
Retrieving tweets for user pewscience: 0it [00:00, ?it/s]
Retrieving tweets for user pewscience
Retrieving tweets for user pewscience: 24it [00:02,  9.99it/s]
pewscience: http://twitter.com/pewscience: 25 tweets scanned, 25 updated
Retrieving tweets for user pewjournalism: 0it [00:00, ?it/s]
Retrieving tweets for user pewjournalism
Retrieving tweets for user pewjournalism: 24it [00:01, 14.20it/s]
pewjournalism: http://twitter.com/pewjournalism: 25 tweets scanned, 25 updated
Retrieving tweets for user pewresearch: 0it [00:00, ?it/s]
Retrieving tweets for user pewresearch
Retrieving tweets for user pewresearch: 24it [00:02, 11.25it/s]
pewresearch: http://twitter.com/pewresearch: 25 tweets scanned, 25 updated
Retrieving tweets for user pvankessel: 0it [00:00, ?it/s]
Retrieving tweets for user pvankessel
Retrieving tweets for user pvankessel: 24it [00:02, 10.63it/s]
pvankessel: http://twitter.com/pvankessel: 25 tweets scanned, 25 updated
Retrieving tweets for user justinbieber: 0it [00:00, ?it/s]
Retrieving tweets for user justinbieber
Retrieving tweets for user justinbieber: 24it [00:02,  9.66it/s]
justinbieber: http://twitter.com/justinbieber: 25 tweets scanned, 25 updated
100%|██████████| 11/11 [00:27&lt;00:00,  2.49s/it]
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TwitterProfileSet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_second_profile_set&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">11</span>
</pre></div>
</div>
</div>
<div class="section" id="followers-and-followings-lists">
<h2>Followers and followings lists<a class="headerlink" href="#followers-and-followings-lists" title="Permalink to this headline">¶</a></h2>
<p>So that’s how to collect profile and tweet data, but you also might be
interested in tracking the followers or friends (we call them
“followings”) for particular accounts. For really popular accounts, not
only can it take a super long time to collect all of their followers
from the API, their followers can also change substantially over time.
To that end, Django Twitter stores lists of followers/followings in a
dedicated table, tracking the start and finish time of the data
collection, and storing each list separately every time you collect it.
Let’s see how that works.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span><span class="s2">&quot;django_twitter_get_profile_followers&quot;</span><span class="p">,</span> <span class="s2">&quot;pewresearch&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Retrieving</span> <span class="n">followers</span> <span class="k">for</span> <span class="n">user</span> <span class="n">pewresearch</span><span class="p">:</span> <span class="mi">25</span><span class="n">it</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="mf">58.31</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
</pre></div>
</div>
<p>We now have a TwitterFollowerList object attached to our profile, and if
we take a look at its values in the table, we can see that it logged its
start and finish time (although we forced a limit of 25, so that’s a
little misleading!)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span> <span class="o">=</span> <span class="n">TwitterProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">screen_name</span><span class="o">=</span><span class="s2">&quot;pewresearch&quot;</span><span class="p">)</span>
<span class="n">pew</span><span class="o">.</span><span class="n">follower_lists</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">TwitterFollowerList</span><span class="p">:</span> <span class="n">TwitterFollowerList</span> <span class="nb">object</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">follower_lists</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;start_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">447871</span><span class="p">),</span> <span class="s1">&#39;finish_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">881229</span><span class="p">),</span> <span class="s1">&#39;profile_id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>We can also use a shortcut function on TwitterProfile objects to grab
the most recent list</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">current_follower_list</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">TwitterFollowerList</span><span class="p">:</span> <span class="n">TwitterFollowerList</span> <span class="nb">object</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>And we can jump directly to the profile objects in that list directly
using another shortcut function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">current_followers</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">QuerySet</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1404793895838359552</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1207586894130769922</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1095705562480820224</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1296137977169494017</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">422795601</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1352012895316537345</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1404860475590905857</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">4764251969</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">826425088975183873</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">2230952041</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">2274067960</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">557234082</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1949288179</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">2735032766</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1404812122094247944</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1355955487284502528</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">1281699263639150593</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">3362571939</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">338711547</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="n">TwitterProfile</span><span class="p">:</span> <span class="mi">756597997</span><span class="o">&gt;</span><span class="p">,</span> <span class="s1">&#39;...(remaining elements truncated)...&#39;</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">current_followers</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">25</span>
</pre></div>
</div>
<p>But as you can see, we pretty much just have a list of Twitter IDs</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">current_followers</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">72</span><span class="p">,</span>
 <span class="s1">&#39;twitter_id&#39;</span><span class="p">:</span> <span class="s1">&#39;1404793895838359552&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_update_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">698450</span><span class="p">),</span>
 <span class="s1">&#39;historical&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;tweet_backfilled&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;twitter_error_code&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;organization_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;most_recent_snapshot_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>
</div>
<p>If we want to ask Twitter to actually provide us with profile info for
each follower, we have to specifically request it - because it eats up a
LOT more API quota. To request this data, you just need to pass
<code class="docutils literal notranslate"><span class="pre">--hydrate</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">call_command</span><span class="p">(</span><span class="s2">&quot;django_twitter_get_profile_followers&quot;</span><span class="p">,</span> <span class="s2">&quot;pewresearch&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span> <span class="n">hydrate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Retrieving</span> <span class="n">followers</span> <span class="k">for</span> <span class="n">user</span> <span class="n">pewresearch</span><span class="p">:</span> <span class="mi">25</span><span class="n">it</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">,</span> <span class="mf">13.30</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">]</span>
</pre></div>
</div>
<p>And now we have actual data, including screen names and profile
snapshots</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">current_followers</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">72</span><span class="p">,</span>
 <span class="s1">&#39;twitter_id&#39;</span><span class="p">:</span> <span class="s1">&#39;1404793895838359552&#39;</span><span class="p">,</span>
 <span class="s1">&#39;last_update_time&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3262</span><span class="p">),</span>
 <span class="s1">&#39;historical&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;tweet_backfilled&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
 <span class="s1">&#39;screen_name&#39;</span><span class="p">:</span> <span class="s1">&#39;garghiv&#39;</span><span class="p">,</span>
 <span class="s1">&#39;created_at&#39;</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">36</span><span class="p">),</span>
 <span class="s1">&#39;twitter_error_code&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;person_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;organization_id&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
 <span class="s1">&#39;most_recent_snapshot_id&#39;</span><span class="p">:</span> <span class="mi">1148</span><span class="p">}</span>
</pre></div>
</div>
<p>So we can do fancy things like, see how many of &#64;pewresearch’s followers
have at least 10 followers themselves</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pew</span><span class="o">.</span><span class="n">current_followers</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">most_recent_snapshot__followers_count__gte</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">18</span>
</pre></div>
</div>
<p>Followings works the exact same way - just substitute the word
“follower” for “following”</p>
</div>
<div class="section" id="data-auditing-utilities-looking-for-account-and-coverage-errors">
<h2>Data auditing utilities (looking for account and coverage errors)<a class="headerlink" href="#data-auditing-utilities-looking-for-account-and-coverage-errors" title="Permalink to this headline">¶</a></h2>
<p>When you’re working with social media data, there can be a lot of moving
parts, and occasionally bad data can slip into your database. Maybe a
handle that you got from a third-party list was outdated, or someone
gave you a fake username that turned out to be a spam bot, or someone
that you’ve been tracking deleted their profile and it immediately got
picked up by a spam bot. There are ways to minimize the risk of all of
this happening, but there’s no substitute for doing manual spot-checks!
Fortunately, Django Twitter offers some utility functions to help you
check for weird accounts.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">django_twitter.utils</span></code> there are two functions that take a set of
profiles and compute their average text similarity to each other by
looking at a sample of their recent tweets
(<code class="docutils literal notranslate"><span class="pre">identify_unusual_profiles_by_tweet_text</span></code>) or their profile
descriptions (<code class="docutils literal notranslate"><span class="pre">identify_unusual_profiles_by_descriptions</span></code>). Usually
we’re interested in tracking accounts that have something in common -
politicians, news organizations, celebrities and other public figures.
In some cases, it’s reasonable to assume that the accounts in our
collection will tweet similar content - or at least, their tweets will
be more similar to each other than the tweets produced by a spam bot.</p>
<p>In our example, it turns out that Justin Bieber’s tweets are so reliably
different than the content produced by the Pew Research accounts, that
we actually use him in our unit tests. (This - and <em>not</em> the fact that
he’s the greatest musician of all time - is the reason that he’s in our
example!)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">profiles</span> <span class="o">=</span> <span class="n">TwitterProfileSet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_profile_set&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">identify_unusual_profiles_by_tweet_text</span>
<span class="n">most_similar</span><span class="p">,</span> <span class="n">most_unique</span> <span class="o">=</span> <span class="n">identify_unusual_profiles_by_tweet_text</span><span class="p">(</span><span class="n">profiles</span><span class="p">)</span>
<span class="n">most_unique</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Gathering tweet text: 100%|██████████| 11/11 [00:00&lt;00:00, 90.31it/s]
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>twitter_id</th>
      <th>tweet_text</th>
      <th>avg_cosine</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>27260086</td>
      <td>RT @MIAFestival: LINEUP ALERT!\nJustin Bieber,...</td>
      <td>0.504817</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">identify_unusual_profiles_by_descriptions</span>
<span class="n">most_similar</span><span class="p">,</span> <span class="n">most_unique</span> <span class="o">=</span> <span class="n">identify_unusual_profiles_by_descriptions</span><span class="p">(</span><span class="n">profiles</span><span class="p">)</span>
<span class="n">most_unique</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>twitter_id</th>
      <th>snapshots__description</th>
      <th>avg_cosine</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>27260086</td>
      <td>JUSTICE the album out now</td>
      <td>0.163522</td>
    </tr>
  </tbody>
</table>
</div><p>Even if you have a perfect account roster with no accidental Biebers,
different Twitter accounts posts at different rates, and Twitter only
provides each account’s ~3200 most recent tweets. If you’re interested
in doing any sort of historical analysis on any period prior to when you
began regular data collection, you’re going to need to assess how far
back the backfill process got you. You may have years’ worth of tweets
for some accounts, but only weeks for others.</p>
<p>Django Twitter provides two functions to assess tweet coverage over time
for a set of profiles you’re interested in. The
<code class="docutils literal notranslate"><span class="pre">get_monthly_twitter_activity</span></code> function produces a spreadsheet where
every row is an account and every column is a month, across whatever
timeframe you request. The cells contain how many tweets exist in the
database for each profile/month, and if you load this spreadsheet into
Excel and do some conditional formatting to highlight empty cells, it
makes it super easy to tell how far back you can reasonably analyze data
without losing a ton of coverage.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">get_monthly_twitter_activity</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">get_monthly_twitter_activity</span><span class="p">(</span>
    <span class="n">profiles</span><span class="p">,</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">max_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2020_12</th>
      <th>2021_1</th>
      <th>2021_2</th>
      <th>2021_3</th>
      <th>2021_4</th>
      <th>2021_5</th>
      <th>2021_6</th>
      <th>pk</th>
      <th>screen_name</th>
      <th>created_at</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1.0</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>29.0</td>
      <td>1.0</td>
      <td>pewresearch</td>
      <td>2009-03-03 10:39:39</td>
      <td>Pew Research Center</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>26.0</td>
      <td>2.0</td>
      <td>pewglobal</td>
      <td>2012-09-18 12:08:41</td>
      <td>Pew Research Global</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>3.0</td>
      <td>pewmethods</td>
      <td>2015-02-09 16:00:41</td>
      <td>Pew Research Methods</td>
    </tr>
    <tr>
      <th>8.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>4.0</td>
      <td>pewjournalism</td>
      <td>2010-02-04 09:42:57</td>
      <td>Pew Research Journalism</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>27.0</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>facttank</td>
      <td>2013-03-13 18:41:33</td>
      <td>Pew Research Fact Tank</td>
    </tr>
    <tr>
      <th>7.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>6.0</td>
      <td>pewscience</td>
      <td>2013-03-12 14:42:00</td>
      <td>Pew Research Science</td>
    </tr>
    <tr>
      <th>9.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>17.0</td>
      <td>7.0</td>
      <td>pewreligion</td>
      <td>2009-04-29 15:03:06</td>
      <td>Pew Research Religion</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>14.0</td>
      <td>5.0</td>
      <td>8.0</td>
      <td>pewhispanic</td>
      <td>2011-12-01 13:26:52</td>
      <td>PewResearch Hispanic</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>25.0</td>
      <td>9.0</td>
      <td>pewinternet</td>
      <td>2008-10-30 13:40:17</td>
      <td>Pew Research Internet</td>
    </tr>
    <tr>
      <th>10.0</th>
      <td>1.0</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>8.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
      <td>pvankessel</td>
      <td>2012-03-19 22:58:08</td>
      <td>Patrick van Kessel</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>7.0</td>
      <td>7.0</td>
      <td>11.0</td>
      <td>11.0</td>
      <td>justinbieber</td>
      <td>2009-03-28 11:41:22</td>
      <td>Justin Bieber</td>
    </tr>
  </tbody>
</table>
</div><p>The second function, <code class="docutils literal notranslate"><span class="pre">find_missing_date_ranges</span></code>, scans a time period
and returns a dataframe of all periods of at least N consecutive days
where a profile doesn’t have any tweets in the database. This can be
useful to search around for weird anomalies that may have been caused by
data collection errors, or temporarily suspended accounts, etc.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">find_missing_date_ranges</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">find_missing_date_ranges</span><span class="p">(</span>
    <span class="n">profiles</span><span class="p">,</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">max_date</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">min_consecutive_missing_dates</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Scanning profiles for missing dates: 100%|██████████| 11/11 [00:00&lt;00:00, 189.21it/s]
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>twitter_id</th>
      <th>start_date</th>
      <th>end_date</th>
      <th>range</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>111339670</td>
      <td>2021-01-01</td>
      <td>2021-06-11</td>
      <td>161</td>
    </tr>
    <tr>
      <th>22</th>
      <td>1262729180</td>
      <td>2021-01-01</td>
      <td>2021-06-03</td>
      <td>153</td>
    </tr>
    <tr>
      <th>21</th>
      <td>3015897974</td>
      <td>2021-01-01</td>
      <td>2021-06-02</td>
      <td>152</td>
    </tr>
    <tr>
      <th>20</th>
      <td>17071048</td>
      <td>2021-01-01</td>
      <td>2021-06-01</td>
      <td>151</td>
    </tr>
    <tr>
      <th>18</th>
      <td>831470472</td>
      <td>2021-01-01</td>
      <td>2021-06-01</td>
      <td>151</td>
    </tr>
    <tr>
      <th>24</th>
      <td>36462231</td>
      <td>2021-01-01</td>
      <td>2021-05-25</td>
      <td>144</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1265726480</td>
      <td>2021-01-01</td>
      <td>2021-04-27</td>
      <td>116</td>
    </tr>
    <tr>
      <th>10</th>
      <td>426041590</td>
      <td>2021-01-01</td>
      <td>2021-04-22</td>
      <td>111</td>
    </tr>
    <tr>
      <th>6</th>
      <td>22642788</td>
      <td>2021-01-16</td>
      <td>2021-04-30</td>
      <td>104</td>
    </tr>
    <tr>
      <th>0</th>
      <td>27260086</td>
      <td>2021-01-01</td>
      <td>2021-04-13</td>
      <td>102</td>
    </tr>
    <tr>
      <th>29</th>
      <td>530977797</td>
      <td>2021-04-27</td>
      <td>2021-06-16</td>
      <td>50</td>
    </tr>
    <tr>
      <th>28</th>
      <td>530977797</td>
      <td>2021-03-15</td>
      <td>2021-04-26</td>
      <td>42</td>
    </tr>
    <tr>
      <th>26</th>
      <td>530977797</td>
      <td>2021-01-26</td>
      <td>2021-03-05</td>
      <td>38</td>
    </tr>
    <tr>
      <th>7</th>
      <td>22642788</td>
      <td>2021-05-05</td>
      <td>2021-05-22</td>
      <td>17</td>
    </tr>
    <tr>
      <th>5</th>
      <td>22642788</td>
      <td>2021-01-01</td>
      <td>2021-01-15</td>
      <td>14</td>
    </tr>
    <tr>
      <th>25</th>
      <td>530977797</td>
      <td>2021-01-01</td>
      <td>2021-01-15</td>
      <td>14</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1265726480</td>
      <td>2021-05-06</td>
      <td>2021-05-20</td>
      <td>14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>27260086</td>
      <td>2021-05-25</td>
      <td>2021-06-06</td>
      <td>12</td>
    </tr>
    <tr>
      <th>19</th>
      <td>831470472</td>
      <td>2021-06-02</td>
      <td>2021-06-11</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>27260086</td>
      <td>2021-05-15</td>
      <td>2021-05-24</td>
      <td>9</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1265726480</td>
      <td>2021-06-08</td>
      <td>2021-06-16</td>
      <td>8</td>
    </tr>
    <tr>
      <th>12</th>
      <td>426041590</td>
      <td>2021-05-26</td>
      <td>2021-06-03</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>22642788</td>
      <td>2021-05-26</td>
      <td>2021-06-02</td>
      <td>7</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27260086</td>
      <td>2021-04-14</td>
      <td>2021-04-20</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>22642788</td>
      <td>2021-06-08</td>
      <td>2021-06-14</td>
      <td>6</td>
    </tr>
    <tr>
      <th>11</th>
      <td>426041590</td>
      <td>2021-05-06</td>
      <td>2021-05-12</td>
      <td>6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>1265726480</td>
      <td>2021-06-02</td>
      <td>2021-06-07</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>27260086</td>
      <td>2021-04-28</td>
      <td>2021-05-03</td>
      <td>5</td>
    </tr>
    <tr>
      <th>27</th>
      <td>530977797</td>
      <td>2021-03-09</td>
      <td>2021-03-14</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>426041590</td>
      <td>2021-06-09</td>
      <td>2021-06-14</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="extracting-exporting-data">
<h2>Extracting/exporting data<a class="headerlink" href="#extracting-exporting-data" title="Permalink to this headline">¶</a></h2>
<p>Finally, let’s take a look at exporting our data. Often we want a giant
spreadsheet of tweets, or a spreadsheet of a profile’s data (like
follower counts) over time. The <code class="docutils literal notranslate"><span class="pre">get_twitter_profile_dataframe</span></code> can
grab the latter for you, and the <code class="docutils literal notranslate"><span class="pre">get_tweet_dataframe</span></code> function gives
you the former. Presumably we’ve inspected our tweet coverage using the
functions above and have determined that we don’t have any tweet
coverage issues, but when it comes to profile data, it’s possible that
we haven’t been collecting that as regularly, or we may have some gaps
in our timeseries. To help with this, the
<code class="docutils literal notranslate"><span class="pre">get_twitter_profile_dataframe</span></code> function uses linear interpolation
(for numerical values) and front-filling (for fixed attributes like
descriptions) to fill in gaps where it can and provide you with a
complete day-by-day profile dataframe that can be merged in with tweets
on the days they were created.</p>
<p>Since we just started collecting data, we only have profile snapshots
for today. So to illustrate how the interpolation works, we’re going to
create a fake snapshot on that historic and fateful day when Justin
Bieber first joined Twitter in 2009, and we’re just going to approximate
his followers by assuming that they’ve increased at a steady linear
rate. (This is obviously a poor assumption, but it works really well for
shorter periods, which is all you should have to fill in if you’ve been
collecting data at least somewhat regularly and aren’t making fake
decade-old datapoints like I am.)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">testapp.models</span> <span class="k">import</span> <span class="n">TwitterProfileSnapshot</span>
<span class="n">justin</span> <span class="o">=</span> <span class="n">TwitterProfile</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">twitter_id</span><span class="o">=</span><span class="s2">&quot;27260086&quot;</span><span class="p">)</span>
<span class="n">fake_snapshot</span> <span class="o">=</span> <span class="n">TwitterProfileSnapshot</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">profile</span><span class="o">=</span><span class="n">justin</span><span class="p">,</span>
    <span class="n">screen_name</span><span class="o">=</span><span class="n">justin</span><span class="o">.</span><span class="n">most_recent_snapshot</span><span class="o">.</span><span class="n">screen_name</span><span class="p">,</span>
    <span class="n">followers_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">favorites_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">followings_count</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">statuses_count</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span>
<span class="n">fake_snapshot</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">justin</span><span class="o">.</span><span class="n">created_at</span>
<span class="n">fake_snapshot</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>Now let’s get our dataframe</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">get_twitter_profile_dataframe</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">get_twitter_profile_dataframe</span><span class="p">(</span>
    <span class="n">profiles</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(),</span> <span class="n">skip_interpolation</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;twitter_id&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;27260086&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;followers_count&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Extracting Twitter profile snapshots: 100%|██████████| 11/11 [00:00&lt;00:00, 13.85it/s]
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>description</th>
      <th>followers_count</th>
      <th>favorites_count</th>
      <th>followings_count</th>
      <th>listed_count</th>
      <th>statuses_count</th>
      <th>name</th>
      <th>screen_name</th>
      <th>status</th>
      <th>is_verified</th>
      <th>is_protected</th>
      <th>location</th>
      <th>created_at</th>
      <th>twitter_error_code</th>
      <th>twitter_id</th>
      <th>pk</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4297</th>
      <td>2021-01-01</td>
      <td></td>
      <td>1.096499e+08</td>
      <td>4416.414612</td>
      <td>278319.829449</td>
      <td>NaN</td>
      <td>30215.748991</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4298</th>
      <td>2021-01-02</td>
      <td></td>
      <td>1.096755e+08</td>
      <td>4417.442403</td>
      <td>278384.600179</td>
      <td>NaN</td>
      <td>30222.780816</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4299</th>
      <td>2021-01-03</td>
      <td></td>
      <td>1.097010e+08</td>
      <td>4418.470193</td>
      <td>278449.370910</td>
      <td>NaN</td>
      <td>30229.812640</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4300</th>
      <td>2021-01-04</td>
      <td></td>
      <td>1.097265e+08</td>
      <td>4419.497983</td>
      <td>278514.141641</td>
      <td>NaN</td>
      <td>30236.844464</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4301</th>
      <td>2021-01-05</td>
      <td></td>
      <td>1.097520e+08</td>
      <td>4420.525773</td>
      <td>278578.912371</td>
      <td>NaN</td>
      <td>30243.876289</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4458</th>
      <td>2021-06-11</td>
      <td></td>
      <td>1.137583e+08</td>
      <td>4581.888839</td>
      <td>288747.917078</td>
      <td>NaN</td>
      <td>31347.872703</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4459</th>
      <td>2021-06-12</td>
      <td></td>
      <td>1.137838e+08</td>
      <td>4582.916629</td>
      <td>288812.687808</td>
      <td>NaN</td>
      <td>31354.904527</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4460</th>
      <td>2021-06-13</td>
      <td></td>
      <td>1.138093e+08</td>
      <td>4583.944420</td>
      <td>288877.458539</td>
      <td>NaN</td>
      <td>31361.936351</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4461</th>
      <td>2021-06-14</td>
      <td></td>
      <td>1.138349e+08</td>
      <td>4584.972210</td>
      <td>288942.229269</td>
      <td>NaN</td>
      <td>31368.968176</td>
      <td></td>
      <td>justinbieber</td>
      <td></td>
      <td>None</td>
      <td>None</td>
      <td></td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
    <tr>
      <th>4462</th>
      <td>2021-06-15</td>
      <td>JUSTICE the album out now</td>
      <td>1.138604e+08</td>
      <td>4586.000000</td>
      <td>289007.000000</td>
      <td>543037.0</td>
      <td>31376.000000</td>
      <td>Justin Bieber</td>
      <td>justinbieber</td>
      <td>RT @MIAFestival: LINEUP ALERT!\nJustin Bieber,...</td>
      <td>True</td>
      <td>False</td>
      <td>The 6</td>
      <td>2009-03-28 11:41:22</td>
      <td>None</td>
      <td>27260086</td>
      <td>11</td>
    </tr>
  </tbody>
</table>
<p>166 rows × 17 columns</p>
</div><p>If we want tweets, it’s a very similar process</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">get_tweet_dataframe</span>
<span class="n">get_tweet_dataframe</span><span class="p">(</span>
    <span class="n">profiles</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pk</th>
      <th>twitter_id</th>
      <th>last_update_time</th>
      <th>historical</th>
      <th>created_at</th>
      <th>text</th>
      <th>retweet_count</th>
      <th>favorite_count</th>
      <th>profile</th>
      <th>retweeted_status</th>
      <th>in_reply_to_status</th>
      <th>quoted_status</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1404865073684828161</td>
      <td>2021-06-15 14:28:19.218205-04:00</td>
      <td>False</td>
      <td>2021-06-15 13:15:09-04:00</td>
      <td>@Katrina_HRM You might also enjoy our short em...</td>
      <td>1</td>
      <td>2</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404850695715659777</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>1404502650398330885</td>
      <td>2021-06-15 14:28:20.497058-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:15:00-04:00</td>
      <td>These are just a few of our findings from our ...</td>
      <td>3</td>
      <td>5</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502648309620743</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>1404502648309620743</td>
      <td>2021-06-15 14:28:20.541835-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:15:00-04:00</td>
      <td>Many of these posts linked to their own conten...</td>
      <td>1</td>
      <td>2</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502645281263616</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32</td>
      <td>1404502645281263616</td>
      <td>2021-06-15 14:28:20.583141-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:14:59-04:00</td>
      <td>59% of posts studied linked to a site outside ...</td>
      <td>0</td>
      <td>1</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502642919972869</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>34</td>
      <td>1404502638482317312</td>
      <td>2021-06-15 14:28:20.699133-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:14:58-04:00</td>
      <td>Beyond a post's main topic, researchers also a...</td>
      <td>1</td>
      <td>1</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502634728411136</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>285</th>
      <td>23</td>
      <td>1404534507055816705</td>
      <td>2021-06-15 14:28:20.230611-04:00</td>
      <td>False</td>
      <td>2021-06-14 15:21:36-04:00</td>
      <td>RT @GalenStocking: 🚨 NEW REPORT 🚨: A study of ...</td>
      <td>5</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404533972193906693</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>286</th>
      <td>11</td>
      <td>1404836235521277955</td>
      <td>2021-06-15 14:28:19.654620-04:00</td>
      <td>False</td>
      <td>2021-06-15 11:20:33-04:00</td>
      <td>RT @pewmethods: To study how 25 popular curren...</td>
      <td>1</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404829803329593344</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>287</th>
      <td>9</td>
      <td>1404836281985740801</td>
      <td>2021-06-15 14:28:19.558623-04:00</td>
      <td>False</td>
      <td>2021-06-15 11:20:44-04:00</td>
      <td>RT @pewinternet: Join us and @DataDotOrg tomor...</td>
      <td>2</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404831838397505540</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>288</th>
      <td>91</td>
      <td>1404851306511089676</td>
      <td>2021-06-15 14:27:59.802896-04:00</td>
      <td>False</td>
      <td>2021-06-15 12:20:27-04:00</td>
      <td>RT @_StephKramer: 1) Quick thread with some fi...</td>
      <td>5</td>
      <td>0</td>
      <td>36462231</td>
      <td>1404846387750215682</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>289</th>
      <td>5</td>
      <td>1404847185922035721</td>
      <td>2021-06-15 14:28:19.385485-04:00</td>
      <td>False</td>
      <td>2021-06-15 12:04:04-04:00</td>
      <td>RT @_StephKramer: 1) Quick thread with some fi...</td>
      <td>5</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404846387750215682</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
  </tbody>
</table>
<p>290 rows × 13 columns</p>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django_twitter.utils</span> <span class="k">import</span> <span class="n">get_tweet_dataframe</span>
<span class="n">profiles</span> <span class="o">=</span> <span class="n">TwitterProfileSet</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_profile_set&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">profiles</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="n">get_tweet_dataframe</span><span class="p">(</span>
    <span class="n">profiles</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2021</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pk</th>
      <th>twitter_id</th>
      <th>last_update_time</th>
      <th>historical</th>
      <th>created_at</th>
      <th>text</th>
      <th>retweet_count</th>
      <th>favorite_count</th>
      <th>profile</th>
      <th>retweeted_status</th>
      <th>in_reply_to_status</th>
      <th>quoted_status</th>
      <th>date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1404865073684828161</td>
      <td>2021-06-15 14:28:19.218205-04:00</td>
      <td>False</td>
      <td>2021-06-15 13:15:09-04:00</td>
      <td>@Katrina_HRM You might also enjoy our short em...</td>
      <td>1</td>
      <td>2</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404850695715659777</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30</td>
      <td>1404502650398330885</td>
      <td>2021-06-15 14:28:20.497058-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:15:00-04:00</td>
      <td>These are just a few of our findings from our ...</td>
      <td>3</td>
      <td>5</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502648309620743</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>1404502648309620743</td>
      <td>2021-06-15 14:28:20.541835-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:15:00-04:00</td>
      <td>Many of these posts linked to their own conten...</td>
      <td>1</td>
      <td>2</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502645281263616</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32</td>
      <td>1404502645281263616</td>
      <td>2021-06-15 14:28:20.583141-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:14:59-04:00</td>
      <td>59% of posts studied linked to a site outside ...</td>
      <td>0</td>
      <td>1</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502642919972869</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>34</td>
      <td>1404502638482317312</td>
      <td>2021-06-15 14:28:20.699133-04:00</td>
      <td>False</td>
      <td>2021-06-14 13:14:58-04:00</td>
      <td>Beyond a post's main topic, researchers also a...</td>
      <td>1</td>
      <td>1</td>
      <td>22642788</td>
      <td>None</td>
      <td>1404502634728411136</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>285</th>
      <td>23</td>
      <td>1404534507055816705</td>
      <td>2021-06-15 14:28:20.230611-04:00</td>
      <td>False</td>
      <td>2021-06-14 15:21:36-04:00</td>
      <td>RT @GalenStocking: 🚨 NEW REPORT 🚨: A study of ...</td>
      <td>5</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404533972193906693</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-14</td>
    </tr>
    <tr>
      <th>286</th>
      <td>11</td>
      <td>1404836235521277955</td>
      <td>2021-06-15 14:28:19.654620-04:00</td>
      <td>False</td>
      <td>2021-06-15 11:20:33-04:00</td>
      <td>RT @pewmethods: To study how 25 popular curren...</td>
      <td>1</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404829803329593344</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>287</th>
      <td>9</td>
      <td>1404836281985740801</td>
      <td>2021-06-15 14:28:19.558623-04:00</td>
      <td>False</td>
      <td>2021-06-15 11:20:44-04:00</td>
      <td>RT @pewinternet: Join us and @DataDotOrg tomor...</td>
      <td>2</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404831838397505540</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>288</th>
      <td>91</td>
      <td>1404851306511089676</td>
      <td>2021-06-15 14:27:59.802896-04:00</td>
      <td>False</td>
      <td>2021-06-15 12:20:27-04:00</td>
      <td>RT @_StephKramer: 1) Quick thread with some fi...</td>
      <td>5</td>
      <td>0</td>
      <td>36462231</td>
      <td>1404846387750215682</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
    <tr>
      <th>289</th>
      <td>5</td>
      <td>1404847185922035721</td>
      <td>2021-06-15 14:28:19.385485-04:00</td>
      <td>False</td>
      <td>2021-06-15 12:04:04-04:00</td>
      <td>RT @_StephKramer: 1) Quick thread with some fi...</td>
      <td>5</td>
      <td>0</td>
      <td>22642788</td>
      <td>1404846387750215682</td>
      <td>None</td>
      <td>None</td>
      <td>2021-06-15</td>
    </tr>
  </tbody>
</table>
<p>290 rows × 13 columns</p>
</div></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="commands.html" class="btn btn-neutral float-left" title="django_twitter.management.commands" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Pew Research Center

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>